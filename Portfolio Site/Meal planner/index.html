<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Dinner Planner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --primary: #e8734a;
            --primary-dark: #d4553a;
            --primary-light: #fef3ec;
            --green: #22c55e;
            --green-light: #dcfce7;
            --green-dark: #16a34a;
            --bg: #faf7f4;
            --card: #ffffff;
            --text: #1a1a2e;
            --text-muted: #6b7280;
            --border: #e5e1dc;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.08), 0 2px 4px rgba(0,0,0,0.04);
            --shadow-lg: 0 12px 32px rgba(0,0,0,0.12), 0 4px 8px rgba(0,0,0,0.06);
            --shadow-xl: 0 20px 48px rgba(0,0,0,0.16);
            --radius: 16px;
            --radius-sm: 10px;
            --radius-full: 100px;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ===== HEADER ===== */
        header {
            background: linear-gradient(135deg, #ff6b3d 0%, #e8734a 30%, #d4553a 70%, #c0392b 100%);
            color: white;
            text-align: center;
            padding: 3rem 1.5rem 2.5rem;
            position: relative;
            overflow: hidden;
        }
        header::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 20% 80%, rgba(255,255,255,0.15) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%);
        }
        header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 40px;
            background: var(--bg);
            border-radius: 40px 40px 0 0;
        }
        .header-content {
            position: relative;
            z-index: 1;
        }
        .header-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            display: inline-block;
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            margin-bottom: 0.25rem;
        }
        header p {
            opacity: 0.9;
            font-size: 1.05rem;
            font-weight: 400;
        }

        /* ===== NAV ===== */
        nav {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: var(--card);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 50;
            flex-wrap: wrap;
            backdrop-filter: blur(12px);
            background: rgba(255,255,255,0.92);
        }
        nav button {
            padding: 0.55rem 1.5rem;
            border: 2px solid transparent;
            background: var(--bg);
            color: var(--text-muted);
            border-radius: var(--radius-full);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            font-family: inherit;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        nav button::after {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--primary);
            opacity: 0;
            transition: opacity 0.3s;
            border-radius: inherit;
        }
        nav button:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-1px);
        }
        nav button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(232, 115, 74, 0.35);
        }

        /* ===== MAIN ===== */
        main {
            max-width: 1080px;
            margin: 0 auto;
            padding: 2rem 1.5rem 4rem;
        }

        /* ===== SECTIONS ===== */
        .section {
            display: none;
            opacity: 0;
            transform: translateY(12px);
        }
        .section.active {
            display: block;
            animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(12px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 1.75rem;
            font-weight: 800;
            margin-bottom: 0.25rem;
            color: var(--text);
            letter-spacing: -0.02em;
        }
        .section-subtitle {
            color: var(--text-muted);
            margin-bottom: 1.75rem;
            font-size: 0.95rem;
        }

        /* ===== FILTER BAR ===== */
        .filter-bar {
            display: flex;
            gap: 0.4rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        .filter-bar button {
            padding: 0.4rem 1rem;
            border: 1.5px solid var(--border);
            background: var(--card);
            border-radius: var(--radius-full);
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-muted);
            font-family: inherit;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .filter-bar button:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: var(--primary-light);
            transform: translateY(-1px);
        }
        .filter-bar button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 2px 8px rgba(232, 115, 74, 0.3);
        }

        /* ===== MEAL CARDS GRID ===== */
        .meal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        .meal-card {
            background: var(--card);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
            transform: translateY(20px);
            animation: cardEnter 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            position: relative;
        }
        .meal-card::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: var(--radius);
            border: 2px solid transparent;
            transition: border-color 0.3s;
            z-index: 1;
            pointer-events: none;
        }
        .meal-card:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: var(--shadow-lg);
        }
        .meal-card:hover::before {
            border-color: rgba(232, 115, 74, 0.3);
        }
        .meal-card:active {
            transform: translateY(-2px) scale(0.99);
        }

        @keyframes cardEnter {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .meal-card-img {
            height: 170px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4.5rem;
            position: relative;
            overflow: hidden;
        }
        .meal-card-img::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: linear-gradient(transparent, rgba(255,255,255,0.8));
        }
        .meal-card-img .card-emoji {
            transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1;
        }
        .meal-card:hover .card-emoji {
            transform: scale(1.15) rotate(-5deg);
        }

        .meal-card-body {
            padding: 1rem 1.25rem 1.25rem;
        }
        .meal-card-body h3 {
            font-size: 1.05rem;
            font-weight: 700;
            margin-bottom: 0.4rem;
            letter-spacing: -0.01em;
        }
        .meal-card-meta {
            display: flex;
            gap: 0.75rem;
            font-size: 0.78rem;
            color: var(--text-muted);
            margin-top: 0.6rem;
            font-weight: 500;
        }
        .meal-card-meta span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* ===== BADGES ===== */
        .badge {
            display: inline-block;
            background: var(--primary-light);
            color: var(--primary);
            padding: 0.2rem 0.65rem;
            border-radius: var(--radius-full);
            font-size: 0.7rem;
            font-weight: 600;
            letter-spacing: 0.01em;
            margin-right: 0.25rem;
            margin-bottom: 0.2rem;
        }
        .badge.green { background: var(--green-light); color: var(--green-dark); }

        /* ===== MODAL ===== */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0);
            z-index: 100;
            justify-content: center;
            align-items: flex-start;
            padding: 3rem 1rem;
            overflow-y: auto;
            transition: background 0.35s;
        }
        .modal-overlay.open {
            display: flex;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
        .modal {
            background: var(--card);
            border-radius: 20px;
            max-width: 620px;
            width: 100%;
            overflow: hidden;
            animation: modalIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            box-shadow: var(--shadow-xl);
        }
        @keyframes modalIn {
            from { opacity: 0; transform: translateY(40px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .modal-header {
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        .modal-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(transparent, rgba(255,255,255,0.6));
        }
        .modal-emoji {
            font-size: 5.5rem;
            animation: modalEmojiBounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s both;
        }
        @keyframes modalEmojiBounce {
            from { transform: scale(0) rotate(-10deg); }
            to { transform: scale(1) rotate(0deg); }
        }
        .modal-close {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(4px);
            font-size: 1.3rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
            transition: all 0.2s;
            box-shadow: var(--shadow-sm);
        }
        .modal-close:hover {
            background: white;
            transform: rotate(90deg) scale(1.1);
            box-shadow: var(--shadow-md);
        }

        .modal-body {
            padding: 1.75rem;
        }
        .modal-body h2 {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 0.25rem;
            letter-spacing: -0.02em;
        }
        .modal-body .meta-row {
            display: flex;
            gap: 1.25rem;
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-bottom: 1rem;
            font-weight: 500;
        }
        .modal-body h4 {
            font-size: 0.95rem;
            font-weight: 700;
            margin: 1.5rem 0 0.6rem;
            color: var(--primary-dark);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 0.8rem;
        }
        .modal-body ul {
            padding-left: 0;
            list-style: none;
        }
        .modal-body ul li {
            margin-bottom: 0.35rem;
            padding: 0.3rem 0 0.3rem 1.5rem;
            position: relative;
            font-size: 0.92rem;
        }
        .modal-body ul li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary-light);
            border: 2px solid var(--primary);
        }
        .modal-body ol {
            padding-left: 0;
            counter-reset: steps;
            list-style: none;
        }
        .modal-body ol li {
            margin-bottom: 0.75rem;
            padding: 0.75rem 0.75rem 0.75rem 3rem;
            position: relative;
            background: var(--bg);
            border-radius: var(--radius-sm);
            font-size: 0.92rem;
            counter-increment: steps;
            transition: background 0.2s;
        }
        .modal-body ol li:hover {
            background: var(--primary-light);
        }
        .modal-body ol li::before {
            content: counter(steps);
            position: absolute;
            left: 0.75rem;
            top: 0.75rem;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            font-size: 0.75rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ===== BUTTONS ===== */
        .shopping-list-btn {
            margin-top: 1.5rem;
            width: 100%;
            padding: 0.85rem;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 0.95rem;
            font-weight: 700;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(232, 115, 74, 0.3);
        }
        .shopping-list-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(232, 115, 74, 0.4);
        }
        .shopping-list-btn:active {
            transform: translateY(0);
        }

        /* ===== SHOPPING LIST POPUP ===== */
        .shopping-popup {
            max-height: 0;
            overflow: hidden;
            background: linear-gradient(135deg, #fef9f5, #fff5ee);
            border: 2px solid var(--primary);
            border-radius: var(--radius-sm);
            margin-top: 1rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
        }
        .shopping-popup.open {
            max-height: 500px;
            padding: 1.25rem;
            opacity: 1;
        }
        .shopping-popup h4 {
            color: var(--primary-dark);
            margin-bottom: 0.6rem;
            font-weight: 700;
        }
        .shopping-popup li {
            list-style: none;
            padding: 0.35rem 0;
            font-size: 0.92rem;
            transition: color 0.2s;
        }
        .shopping-popup li::before {
            content: "\2610 ";
            color: var(--primary);
            font-size: 1.1rem;
        }
        .copy-btn {
            margin-top: 0.75rem;
            padding: 0.5rem 1.25rem;
            border: 2px solid var(--primary);
            background: white;
            color: var(--primary);
            border-radius: var(--radius-full);
            cursor: pointer;
            font-weight: 600;
            font-family: inherit;
            font-size: 0.85rem;
            transition: all 0.25s;
        }
        .copy-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-1px);
        }

        /* ===== INGREDIENT MATCHER ===== */
        .matcher-box {
            background: var(--card);
            border-radius: var(--radius);
            padding: 1.75rem;
            box-shadow: var(--shadow-md);
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
        }
        .matcher-box strong {
            font-size: 0.9rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 0.78rem;
        }
        .chip-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
        }
        .chip {
            padding: 0.45rem 0.95rem;
            border-radius: var(--radius-full);
            border: 1.5px solid var(--border);
            background: var(--card);
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            font-family: inherit;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            user-select: none;
        }
        .chip:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(232, 115, 74, 0.15);
        }
        .chip.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 2px 8px rgba(232, 115, 74, 0.3);
            transform: translateY(-1px);
            animation: chipPop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        @keyframes chipPop {
            0% { transform: scale(0.9); }
            50% { transform: scale(1.08) translateY(-2px); }
            100% { transform: scale(1) translateY(-1px); }
        }

        .custom-input-row {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        .custom-input-row input {
            flex: 1;
            padding: 0.6rem 1rem;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
            outline: none;
        }
        .custom-input-row input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(232, 115, 74, 0.15);
        }
        .custom-input-row button {
            padding: 0.6rem 1.5rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 700;
            font-family: inherit;
            transition: all 0.25s;
        }
        .custom-input-row button:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .match-results {
            margin-top: 1.5rem;
        }
        .match-results h3 {
            margin-bottom: 1rem;
            font-weight: 800;
            font-size: 1.2rem;
            color: var(--text);
        }
        .match-card {
            background: var(--card);
            border-radius: var(--radius);
            padding: 1.25rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            border: 1px solid var(--border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
            animation: matchCardIn 0.4s ease forwards;
        }
        .match-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-3px);
            border-color: rgba(232, 115, 74, 0.3);
        }
        @keyframes matchCardIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .match-card h4 {
            margin-bottom: 0.3rem;
            font-size: 1.05rem;
            font-weight: 700;
        }
        .match-info {
            font-size: 0.85rem;
            color: var(--text-muted);
            font-weight: 500;
        }
        .match-have { color: var(--green-dark); font-weight: 700; }
        .match-need { color: var(--primary); }
        .tag-row {
            display: flex;
            gap: 0.4rem;
            flex-wrap: wrap;
            margin-top: 0.6rem;
        }
        .tag-have {
            font-size: 0.72rem;
            background: var(--green-light);
            color: var(--green-dark);
            padding: 0.2rem 0.6rem;
            border-radius: var(--radius-full);
            font-weight: 600;
        }
        .tag-need {
            font-size: 0.72rem;
            background: var(--primary-light);
            color: var(--primary);
            padding: 0.2rem 0.6rem;
            border-radius: var(--radius-full);
            font-weight: 600;
        }
        .no-results {
            text-align: center;
            padding: 3rem;
            color: var(--text-muted);
            font-size: 1rem;
        }

        /* ===== PROGRESS BAR (Matcher) ===== */
        .match-progress {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.4rem;
        }
        .progress-bar {
            flex: 1;
            height: 6px;
            background: #eee;
            border-radius: 3px;
            overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .progress-bar-fill.full { background: linear-gradient(90deg, var(--green), #34d399); }
        .progress-bar-fill.partial { background: linear-gradient(90deg, var(--primary), #fb923c); }
        .progress-text {
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--text-muted);
            min-width: 35px;
            text-align: right;
        }

        /* ===== WEEKLY PLAN ===== */
        .plan-day {
            background: var(--card);
            border-radius: var(--radius);
            padding: 1.1rem 1.5rem;
            margin-bottom: 0.75rem;
            box-shadow: var(--shadow-sm);
            display: flex;
            align-items: center;
            gap: 1.25rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--border);
            opacity: 0;
            animation: planDayIn 0.4s ease forwards;
        }
        .plan-day:hover {
            box-shadow: var(--shadow-md);
            transform: translateX(6px);
            border-color: rgba(232, 115, 74, 0.3);
        }
        @keyframes planDayIn {
            from { opacity: 0; transform: translateX(-15px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .plan-day .day-label {
            font-weight: 800;
            color: var(--primary);
            min-width: 44px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.03em;
        }
        .plan-day .day-emoji {
            font-size: 2.25rem;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .plan-day:hover .day-emoji {
            transform: scale(1.2) rotate(-8deg);
        }
        .plan-day .day-info { flex: 1; }
        .plan-day .day-info h4 {
            font-size: 1rem;
            font-weight: 700;
        }
        .plan-day .day-info p {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 500;
        }
        .plan-day .day-arrow {
            color: #ccc;
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        .plan-day:hover .day-arrow {
            color: var(--primary);
            transform: translateX(3px);
        }

        .plan-actions {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.75rem;
        }
        .plan-actions button {
            padding: 0.6rem 1.5rem;
            border: 2px solid var(--primary);
            background: var(--card);
            color: var(--primary);
            border-radius: var(--radius-sm);
            font-weight: 700;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .plan-actions button:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(232, 115, 74, 0.3);
        }
        .plan-actions button:active {
            transform: translateY(0);
        }

        .full-shopping-list {
            background: var(--card);
            border-radius: var(--radius);
            padding: 0;
            max-height: 0;
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
            border: 1px solid var(--border);
        }
        .full-shopping-list.open {
            padding: 1.75rem;
            max-height: 2000px;
            opacity: 1;
            margin-top: 1rem;
        }
        .full-shopping-list h3 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-weight: 800;
        }
        .full-shopping-list ul { padding-left: 0; }
        .full-shopping-list li {
            list-style: none;
            padding: 0.45rem 0;
            border-bottom: 1px solid #f5f0eb;
            font-size: 0.92rem;
            transition: background 0.15s;
        }
        .full-shopping-list li:hover { background: var(--primary-light); padding-left: 0.5rem; }
        .full-shopping-list li::before {
            content: "\2610 ";
            color: var(--primary);
            font-size: 1.1rem;
        }

        /* ===== SCROLLBAR ===== */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb {
            background: #d5cdc4;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover { background: #b5ada4; }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 600px) {
            header { padding: 2.5rem 1rem 2rem; }
            header h1 { font-size: 1.6rem; }
            .meal-grid { grid-template-columns: 1fr; }
            main { padding: 1.5rem 1rem; }
            .modal-overlay { padding: 1rem 0.75rem; }
            .plan-day { padding: 0.9rem 1rem; gap: 0.75rem; }
        }
    </style>
</head>
<body>

<header>
    <div class="header-content">
        <div class="header-icon">üçΩÔ∏è</div>
        <h1>Quick Dinner Planner</h1>
        <p>Simple meals, easy shopping lists, dinner sorted.</p>
    </div>
</header>

<nav>
    <button class="active" onclick="showSection('recipes', this)">All Recipes</button>
    <button onclick="showSection('plan', this)">Weekly Plan</button>
    <button onclick="showSection('matcher', this)">What's in My Fridge?</button>
</nav>

<main>
    <!-- ALL RECIPES -->
    <div id="recipes" class="section active">
        <h2 class="section-title">Quick Dinner Recipes</h2>
        <p class="section-subtitle">Tap any meal to see the full recipe, instructions & shopping list.</p>
        <div class="filter-bar" id="filterBar"></div>
        <div class="meal-grid" id="mealGrid"></div>
    </div>

    <!-- WEEKLY PLAN -->
    <div id="plan" class="section">
        <h2 class="section-title">Weekly Meal Plan</h2>
        <p class="section-subtitle">A full week of dinners, ready to go. Click "Shuffle" for a new plan.</p>
        <div class="plan-actions">
            <button onclick="shufflePlan()">&#x1F500; Shuffle Plan</button>
            <button onclick="toggleFullList()">&#x1F6D2; Full Shopping List</button>
        </div>
        <div id="weekPlan"></div>
        <div class="full-shopping-list" id="fullShoppingList"></div>
    </div>

    <!-- INGREDIENT MATCHER -->
    <div id="matcher" class="section">
        <h2 class="section-title">What's in My Fridge?</h2>
        <p class="section-subtitle">Select or type ingredients you have, and we'll suggest meals you can make.</p>
        <div class="matcher-box">
            <strong>Common Ingredients</strong>
            <div class="chip-container" id="commonChips"></div>
            <div class="custom-input-row">
                <input type="text" id="customIngredient" placeholder="Type another ingredient..." onkeydown="if(event.key==='Enter')addCustom()">
                <button onclick="addCustom()">Add</button>
            </div>
        </div>
        <div class="match-results" id="matchResults"></div>
    </div>
</main>

<!-- RECIPE DETAIL MODAL -->
<div class="modal-overlay" id="modal" onclick="if(event.target===this)closeModal()">
    <div class="modal">
        <div class="modal-header" id="modalHeader">
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body" id="modalBody"></div>
    </div>
</div>

<script>
// ============ MEAL DATA ============
const meals = [
    {
        name: "One-Pan Lemon Herb Chicken",
        emoji: "\u{1F357}",
        color: "#ffeaa7",
        time: "30 min",
        servings: 4,
        tags: ["5-ingredient", "one-pan"],
        protein: "chicken",
        ingredients: [
            "4 chicken thighs",
            "2 lemons (juiced + sliced)",
            "3 tbsp olive oil",
            "4 cloves garlic, minced",
            "1 tsp dried oregano",
            "Salt & pepper"
        ],
        shopping: ["Chicken thighs", "Lemons x2", "Garlic", "Dried oregano"],
        steps: [
            "Preheat oven to 200\u00B0C / 400\u00B0F.",
            "Place chicken thighs in a baking dish.",
            "Mix lemon juice, olive oil, garlic, oregano, salt & pepper in a bowl.",
            "Pour mixture over chicken. Lay lemon slices on top.",
            "Bake 25\u201330 minutes until chicken is golden and cooked through.",
            "Serve with rice or crusty bread."
        ]
    },
    {
        name: "15-Minute Garlic Butter Pasta",
        emoji: "\u{1F35D}",
        color: "#ffd8a8",
        time: "15 min",
        servings: 4,
        tags: ["5-ingredient", "vegetarian", "under-20-min"],
        protein: "none",
        ingredients: [
            "400g spaghetti",
            "4 tbsp butter",
            "5 cloves garlic, thinly sliced",
            "1/2 tsp chili flakes",
            "Parmesan cheese",
            "Salt"
        ],
        shopping: ["Spaghetti", "Butter", "Garlic", "Chili flakes", "Parmesan cheese"],
        steps: [
            "Cook spaghetti in salted boiling water until al dente. Reserve 1 cup pasta water.",
            "In a large pan, melt butter over medium heat.",
            "Add sliced garlic and chili flakes, cook 1\u20132 minutes until garlic is golden.",
            "Toss in drained pasta with a splash of pasta water.",
            "Stir until coated and creamy.",
            "Top with grated Parmesan and serve."
        ]
    },
    {
        name: "Easy Beef Stir-Fry",
        emoji: "\u{1F969}",
        color: "#f8c9c9",
        time: "20 min",
        servings: 4,
        tags: ["under-20-min", "high-protein"],
        protein: "beef",
        ingredients: [
            "500g beef strips",
            "2 bell peppers, sliced",
            "1 broccoli head, cut into florets",
            "3 tbsp soy sauce",
            "1 tbsp sesame oil",
            "2 cloves garlic, minced",
            "1 tbsp cornstarch",
            "1 tbsp vegetable oil"
        ],
        shopping: ["Beef strips", "Bell peppers x2", "Broccoli", "Soy sauce", "Sesame oil", "Garlic"],
        steps: [
            "Toss beef strips with soy sauce and cornstarch.",
            "Heat vegetable oil in a wok or large pan over high heat.",
            "Cook beef 2\u20133 minutes until browned. Remove and set aside.",
            "Add a bit more oil, stir-fry peppers and broccoli for 3\u20134 minutes.",
            "Add garlic, cook 30 seconds.",
            "Return beef, drizzle sesame oil, toss everything together.",
            "Serve over steamed rice."
        ]
    },
    {
        name: "5-Ingredient Tomato Soup",
        emoji: "\u{1F345}",
        color: "#ffcccc",
        time: "25 min",
        servings: 4,
        tags: ["5-ingredient", "vegetarian", "budget"],
        protein: "none",
        ingredients: [
            "2 cans (800g) crushed tomatoes",
            "1 onion, diced",
            "2 cloves garlic",
            "1 cup vegetable broth",
            "2 tbsp olive oil",
            "Salt & pepper"
        ],
        shopping: ["Crushed tomatoes x2 cans", "Onion", "Garlic", "Vegetable broth"],
        steps: [
            "Heat olive oil in a pot over medium heat.",
            "Cook onion until soft, about 4 minutes. Add garlic, cook 1 minute.",
            "Pour in crushed tomatoes and broth.",
            "Simmer for 15 minutes.",
            "Blend with a stick blender until smooth (or leave chunky).",
            "Season with salt & pepper. Serve with bread or grilled cheese."
        ]
    },
    {
        name: "Crispy Salmon & Veggies",
        emoji: "\u{1F41F}",
        color: "#b8e6ff",
        time: "25 min",
        servings: 2,
        tags: ["5-ingredient", "high-protein", "one-pan"],
        protein: "fish",
        ingredients: [
            "2 salmon fillets",
            "2 cups green beans",
            "1 tbsp olive oil",
            "1 lemon",
            "2 cloves garlic, minced",
            "Salt & pepper"
        ],
        shopping: ["Salmon fillets x2", "Green beans", "Lemon", "Garlic"],
        steps: [
            "Preheat oven to 200\u00B0C / 400\u00B0F.",
            "Place salmon and green beans on a lined baking tray.",
            "Drizzle with olive oil, squeeze lemon, scatter garlic.",
            "Season with salt & pepper.",
            "Bake 15\u201318 minutes until salmon is crispy on top.",
            "Serve immediately with lemon wedges."
        ]
    },
    {
        name: "Chicken Quesadillas",
        emoji: "\u{1F32E}",
        color: "#fff3b0",
        time: "15 min",
        servings: 4,
        tags: ["under-20-min", "kid-friendly"],
        protein: "chicken",
        ingredients: [
            "2 cups cooked shredded chicken",
            "4 large flour tortillas",
            "2 cups shredded cheese",
            "1/2 cup salsa",
            "1 tbsp butter"
        ],
        shopping: ["Cooked chicken", "Flour tortillas x4", "Shredded cheese", "Salsa"],
        steps: [
            "Lay a tortilla flat. Spread cheese, chicken, and salsa on one half.",
            "Fold in half.",
            "Melt a little butter in a pan over medium heat.",
            "Cook quesadilla 2\u20133 minutes per side until golden and cheese melts.",
            "Repeat for all tortillas.",
            "Cut into wedges and serve with sour cream."
        ]
    },
    {
        name: "Veggie Fried Rice",
        emoji: "\u{1F35A}",
        color: "#d4f5d4",
        time: "15 min",
        servings: 4,
        tags: ["vegetarian", "under-20-min", "budget"],
        protein: "none",
        ingredients: [
            "3 cups cooked rice (day-old is best)",
            "2 eggs",
            "1 cup frozen peas & carrots",
            "3 tbsp soy sauce",
            "2 green onions, sliced",
            "1 tbsp sesame oil",
            "1 tbsp vegetable oil"
        ],
        shopping: ["Cooked rice", "Eggs x2", "Frozen peas & carrots", "Soy sauce", "Green onions", "Sesame oil"],
        steps: [
            "Heat vegetable oil in a wok over high heat.",
            "Scramble eggs, break into small pieces, set aside.",
            "Add frozen peas & carrots, cook 2 minutes.",
            "Add rice, stir-fry 3\u20134 minutes until heated through.",
            "Pour soy sauce and sesame oil over rice, toss well.",
            "Mix eggs back in, top with green onions and serve."
        ]
    },
    {
        name: "Simple Sausage Bake",
        emoji: "\u{1F32D}",
        color: "#f5d5a0",
        time: "35 min",
        servings: 4,
        tags: ["one-pan", "5-ingredient", "kid-friendly"],
        protein: "pork",
        ingredients: [
            "6 sausages",
            "3 potatoes, cubed",
            "1 red onion, quartered",
            "2 tbsp olive oil",
            "1 tsp smoked paprika",
            "Salt & pepper"
        ],
        shopping: ["Sausages x6", "Potatoes x3", "Red onion", "Smoked paprika"],
        steps: [
            "Preheat oven to 200\u00B0C / 400\u00B0F.",
            "Toss cubed potatoes and onion with olive oil, paprika, salt & pepper on a baking tray.",
            "Nestle sausages among the vegetables.",
            "Bake 30\u201335 minutes, turning sausages halfway.",
            "Everything should be golden and crispy.",
            "Serve straight from the tray."
        ]
    },
    {
        name: "Creamy Tuscan Chicken",
        emoji: "\u{1F357}",
        color: "#ffe0b2",
        time: "25 min",
        servings: 4,
        tags: ["high-protein"],
        protein: "chicken",
        ingredients: [
            "4 chicken breasts",
            "1 cup sun-dried tomatoes",
            "2 cups fresh spinach",
            "1 cup heavy cream",
            "3 cloves garlic, minced",
            "1/2 cup Parmesan, grated",
            "1 tbsp olive oil",
            "Salt & pepper"
        ],
        shopping: ["Chicken breasts x4", "Sun-dried tomatoes", "Fresh spinach", "Heavy cream", "Garlic", "Parmesan"],
        steps: [
            "Season chicken with salt & pepper. Sear in olive oil 5\u20136 min per side. Set aside.",
            "In the same pan, add garlic and cook 30 seconds.",
            "Add sun-dried tomatoes and spinach, stir until wilted.",
            "Pour in cream and Parmesan, stir until sauce thickens (2\u20133 min).",
            "Return chicken to pan, spoon sauce over.",
            "Simmer 2 minutes. Serve with pasta or mashed potatoes."
        ]
    },
    {
        name: "Black Bean Tacos",
        emoji: "\u{1F32F}",
        color: "#c8e6c9",
        time: "10 min",
        servings: 4,
        tags: ["vegetarian", "under-20-min", "budget", "5-ingredient"],
        protein: "none",
        ingredients: [
            "1 can black beans, drained",
            "8 small tortillas",
            "1 avocado, sliced",
            "1/2 cup salsa",
            "Lime juice",
            "Salt & cumin to taste"
        ],
        shopping: ["Black beans (canned)", "Small tortillas x8", "Avocado", "Salsa", "Lime"],
        steps: [
            "Heat black beans in a pan with a pinch of cumin and salt.",
            "Warm tortillas in a dry pan or microwave.",
            "Fill tortillas with beans, avocado slices, and salsa.",
            "Squeeze lime juice on top.",
            "Serve immediately."
        ]
    },
    {
        name: "Honey Garlic Pork Chops",
        emoji: "\u{1F356}",
        color: "#ffe0b2",
        time: "20 min",
        servings: 4,
        tags: ["5-ingredient", "high-protein", "under-20-min"],
        protein: "pork",
        ingredients: [
            "4 pork chops",
            "3 tbsp honey",
            "3 cloves garlic, minced",
            "2 tbsp soy sauce",
            "1 tbsp olive oil",
            "Salt & pepper"
        ],
        shopping: ["Pork chops x4", "Honey", "Garlic", "Soy sauce"],
        steps: [
            "Season pork chops with salt & pepper.",
            "Heat olive oil in a pan over medium-high heat.",
            "Sear pork chops 4\u20135 minutes per side. Remove.",
            "In the same pan, add garlic, honey, and soy sauce.",
            "Stir and let it bubble for 1 minute.",
            "Return chops, coat in sauce. Serve with steamed veg."
        ]
    },
    {
        name: "Mushroom Risotto",
        emoji: "\u{1F344}",
        color: "#e8dcc8",
        time: "30 min",
        servings: 4,
        tags: ["vegetarian"],
        protein: "none",
        ingredients: [
            "1.5 cups arborio rice",
            "300g mushrooms, sliced",
            "4 cups vegetable broth (warm)",
            "1 onion, finely diced",
            "1/2 cup white wine (optional)",
            "2 tbsp butter",
            "1/2 cup Parmesan, grated",
            "Salt & pepper"
        ],
        shopping: ["Arborio rice", "Mushrooms 300g", "Vegetable broth", "Onion", "White wine", "Butter", "Parmesan"],
        steps: [
            "Saut\u00E9 onion in butter until soft (3 min).",
            "Add mushrooms, cook until golden (4 min).",
            "Stir in rice, toast for 1 minute.",
            "Add wine if using, stir until absorbed.",
            "Add broth one ladle at a time, stirring after each until absorbed.",
            "Continue for about 18 minutes until rice is creamy.",
            "Stir in Parmesan, season, and serve immediately."
        ]
    },
    {
        name: "Sheet Pan Shrimp Fajitas",
        emoji: "\u{1F990}",
        color: "#ffccbc",
        time: "20 min",
        servings: 4,
        tags: ["one-pan", "under-20-min", "high-protein"],
        protein: "fish",
        ingredients: [
            "500g shrimp, peeled",
            "2 bell peppers, sliced",
            "1 onion, sliced",
            "2 tbsp fajita seasoning",
            "2 tbsp olive oil",
            "Tortillas for serving",
            "Lime wedges"
        ],
        shopping: ["Shrimp 500g", "Bell peppers x2", "Onion", "Fajita seasoning", "Tortillas", "Limes"],
        steps: [
            "Preheat oven to 220\u00B0C / 425\u00B0F.",
            "Toss shrimp, peppers, and onion with oil and fajita seasoning.",
            "Spread on a baking sheet in a single layer.",
            "Bake 10\u201312 minutes until shrimp is pink.",
            "Serve in warm tortillas with lime wedges."
        ]
    },
    {
        name: "Egg Fried Noodles",
        emoji: "\u{1F35C}",
        color: "#fff9c4",
        time: "15 min",
        servings: 2,
        tags: ["under-20-min", "budget", "vegetarian"],
        protein: "none",
        ingredients: [
            "200g egg noodles",
            "2 eggs",
            "2 tbsp soy sauce",
            "1 tbsp sesame oil",
            "2 green onions, sliced",
            "1 carrot, julienned",
            "1 tbsp vegetable oil"
        ],
        shopping: ["Egg noodles", "Eggs x2", "Soy sauce", "Sesame oil", "Green onions", "Carrot"],
        steps: [
            "Cook noodles according to packet, drain.",
            "Heat vegetable oil in a wok over high heat.",
            "Scramble eggs, set aside.",
            "Stir-fry carrot 2 minutes.",
            "Add noodles, soy sauce, and sesame oil. Toss well.",
            "Mix eggs back in, top with green onions."
        ]
    },
    {
        name: "Caprese Chicken",
        emoji: "\u{1F9C0}",
        color: "#ffcdd2",
        time: "25 min",
        servings: 4,
        tags: ["5-ingredient", "high-protein"],
        protein: "chicken",
        ingredients: [
            "4 chicken breasts",
            "4 slices fresh mozzarella",
            "2 tomatoes, sliced",
            "Fresh basil leaves",
            "2 tbsp balsamic glaze",
            "Salt & pepper"
        ],
        shopping: ["Chicken breasts x4", "Fresh mozzarella", "Tomatoes x2", "Fresh basil", "Balsamic glaze"],
        steps: [
            "Preheat oven to 200\u00B0C / 400\u00B0F.",
            "Season chicken with salt & pepper, place in a baking dish.",
            "Top each breast with tomato slices and mozzarella.",
            "Bake 20\u201325 minutes until chicken is cooked.",
            "Top with fresh basil and drizzle balsamic glaze.",
            "Serve with salad or crusty bread."
        ]
    },
    {
        name: "Chili Con Carne",
        emoji: "\u{1FAD8}",
        color: "#d7ccc8",
        time: "35 min",
        servings: 6,
        tags: ["budget", "high-protein", "kid-friendly"],
        protein: "beef",
        ingredients: [
            "500g ground beef",
            "1 can kidney beans, drained",
            "1 can (400g) diced tomatoes",
            "1 onion, diced",
            "2 cloves garlic, minced",
            "2 tbsp chili powder",
            "1 tsp cumin",
            "1 tbsp olive oil",
            "Salt & pepper"
        ],
        shopping: ["Ground beef 500g", "Kidney beans (canned)", "Diced tomatoes (canned)", "Onion", "Garlic", "Chili powder", "Cumin"],
        steps: [
            "Heat oil in a large pot. Cook onion 3 minutes, add garlic.",
            "Add ground beef, break apart, cook until browned (5 min).",
            "Stir in chili powder and cumin.",
            "Add diced tomatoes and kidney beans.",
            "Simmer 20\u201325 minutes, stirring occasionally.",
            "Season with salt & pepper. Serve over rice or with tortilla chips."
        ]
    }
];

// ============ SECTION SWITCHING ============
function showSection(id, btn) {
    document.querySelectorAll('.section').forEach(s => {
        s.classList.remove('active');
        s.style.animation = 'none';
    });
    const section = document.getElementById(id);
    section.classList.add('active');
    section.style.animation = 'none';
    section.offsetHeight; // trigger reflow
    section.style.animation = '';

    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    // Re-trigger stagger animations for cards
    if (id === 'recipes') renderMeals();
    if (id === 'plan') renderPlan();
}

// ============ RENDER RECIPE CARDS ============
const allTags = [...new Set(meals.flatMap(m => m.tags))];
let activeFilter = "all";

function renderFilters() {
    const bar = document.getElementById('filterBar');
    const labelMap = {
        "5-ingredient": "5 Ingredients",
        "one-pan": "One Pan",
        "vegetarian": "Vegetarian",
        "under-20-min": "Under 20 Min",
        "high-protein": "High Protein",
        "budget": "Budget",
        "kid-friendly": "Kid Friendly"
    };
    bar.innerHTML = `<button class="active" onclick="setFilter('all', this)">All</button>` +
        allTags.map(t => `<button onclick="setFilter('${t}', this)">${labelMap[t] || t}</button>`).join('');
}

function setFilter(tag, btn) {
    activeFilter = tag;
    document.querySelectorAll('.filter-bar button').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    renderMeals();
}

function renderMeals() {
    const grid = document.getElementById('mealGrid');
    const filtered = activeFilter === "all" ? meals : meals.filter(m => m.tags.includes(activeFilter));
    grid.innerHTML = filtered.map((m, i) => {
        const idx = meals.indexOf(m);
        const delay = i * 0.06;
        return `
        <div class="meal-card" onclick="openModal(${idx})" style="animation-delay:${delay}s">
            <div class="meal-card-img" style="background:${m.color}">
                <span class="card-emoji">${m.emoji}</span>
            </div>
            <div class="meal-card-body">
                <h3>${m.name}</h3>
                <div>${m.tags.map(t => `<span class="badge${t==='vegetarian'?' green':''}">${t}</span>`).join('')}</div>
                <div class="meal-card-meta">
                    <span>\u{23F1} ${m.time}</span>
                    <span>\u{1F464} ${m.servings}</span>
                    <span>\u{1F955} ${m.ingredients.length}</span>
                </div>
            </div>
        </div>`;
    }).join('');
}

// ============ MODAL ============
function openModal(idx) {
    const m = meals[idx];
    document.getElementById('modalHeader').style.background = m.color;
    document.getElementById('modalHeader').innerHTML = `
        <button class="modal-close" onclick="closeModal()">&times;</button>
        <span class="modal-emoji">${m.emoji}</span>`;
    document.getElementById('modalBody').innerHTML = `
        <h2>${m.name}</h2>
        <div class="meta-row">
            <span>\u{23F1} ${m.time}</span>
            <span>\u{1F464} ${m.servings} servings</span>
            <span>\u{1F955} ${m.ingredients.length} ingredients</span>
        </div>
        <div>${m.tags.map(t => `<span class="badge${t==='vegetarian'?' green':''}">${t}</span>`).join('')}</div>
        <h4>Ingredients</h4>
        <ul>${m.ingredients.map(i => `<li>${i}</li>`).join('')}</ul>
        <h4>Instructions</h4>
        <ol>${m.steps.map(s => `<li>${s}</li>`).join('')}</ol>
        <button class="shopping-list-btn" onclick="toggleShopping(this, ${idx})">
            \u{1F6D2} Show Shopping List
        </button>
        <div class="shopping-popup" id="shopPopup">
            <h4>Shopping List for ${m.name}</h4>
            <ul>${m.shopping.map(s => `<li>${s}</li>`).join('')}</ul>
            <button class="copy-btn" onclick="copyList(${idx})">Copy to Clipboard</button>
        </div>`;
    document.getElementById('modal').classList.add('open');
    document.body.style.overflow = 'hidden';
}

function closeModal() {
    const modal = document.querySelector('.modal');
    modal.style.animation = 'modalOut 0.25s ease forwards';
    setTimeout(() => {
        document.getElementById('modal').classList.remove('open');
        document.body.style.overflow = '';
        modal.style.animation = 'modalIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards';
    }, 220);
}

function toggleShopping(btn, idx) {
    const popup = document.getElementById('shopPopup');
    popup.classList.toggle('open');
    btn.innerHTML = popup.classList.contains('open')
        ? '\u{1F6D2} Hide Shopping List'
        : '\u{1F6D2} Show Shopping List';
}

function copyList(idx) {
    const m = meals[idx];
    const text = `Shopping List: ${m.name}\n` + m.shopping.map(s => `- ${s}`).join('\n');
    navigator.clipboard.writeText(text);
    const btn = event.target;
    btn.textContent = '\u2705 Copied!';
    setTimeout(() => btn.textContent = 'Copy to Clipboard', 1500);
}

// ============ WEEKLY PLAN ============
const days = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
let weekPlanMeals = [];

function shufflePlan() {
    const shuffled = [...meals].sort(() => Math.random() - 0.5);
    weekPlanMeals = shuffled.slice(0, 7);
    renderPlan();
    document.getElementById('fullShoppingList').classList.remove('open');
}

function renderPlan() {
    const el = document.getElementById('weekPlan');
    el.innerHTML = weekPlanMeals.map((m, i) => {
        const idx = meals.indexOf(m);
        const delay = i * 0.07;
        return `
        <div class="plan-day" onclick="openModal(${idx})" style="animation-delay:${delay}s">
            <div class="day-label">${days[i]}</div>
            <div class="day-emoji">${m.emoji}</div>
            <div class="day-info">
                <h4>${m.name}</h4>
                <p>\u{23F1} ${m.time} \u2022 ${m.ingredients.length} ingredients</p>
            </div>
            <div class="day-arrow">\u203A</div>
        </div>`;
    }).join('');
}

function toggleFullList() {
    const el = document.getElementById('fullShoppingList');
    if (el.classList.contains('open')) {
        el.classList.remove('open');
        return;
    }
    const allItems = {};
    weekPlanMeals.forEach(m => {
        m.shopping.forEach(item => { allItems[item] = true; });
    });
    el.innerHTML = `<h3>\u{1F6D2} Full Week Shopping List</h3>
        <ul>${Object.keys(allItems).sort().map(i => `<li>${i}</li>`).join('')}</ul>
        <button class="copy-btn" onclick="copyWeekList()">Copy to Clipboard</button>`;
    el.classList.add('open');
}

function copyWeekList() {
    const allItems = {};
    weekPlanMeals.forEach(m => {
        m.shopping.forEach(item => { allItems[item] = true; });
    });
    const text = "Weekly Shopping List\n" + Object.keys(allItems).sort().map(i => `- ${i}`).join('\n');
    navigator.clipboard.writeText(text);
    const btn = event.target;
    btn.textContent = '\u2705 Copied!';
    setTimeout(() => btn.textContent = 'Copy to Clipboard', 1500);
}

// ============ INGREDIENT MATCHER ============
const commonIngredients = [
    "Chicken", "Beef", "Pork", "Shrimp", "Salmon", "Eggs",
    "Rice", "Pasta", "Noodles", "Tortillas", "Bread",
    "Onion", "Garlic", "Tomatoes", "Bell Peppers", "Broccoli",
    "Potatoes", "Carrots", "Spinach", "Mushrooms", "Avocado",
    "Cheese", "Butter", "Cream", "Soy Sauce", "Olive Oil",
    "Lemon", "Lime", "Black Beans"
];

let selectedIngredients = new Set();

function renderChips() {
    const el = document.getElementById('commonChips');
    el.innerHTML = commonIngredients.map(ing =>
        `<span class="chip${selectedIngredients.has(ing.toLowerCase())?' selected':''}" onclick="toggleChip('${ing}')">${ing}</span>`
    ).join('');
}

function toggleChip(ing) {
    const key = ing.toLowerCase();
    if (selectedIngredients.has(key)) selectedIngredients.delete(key);
    else selectedIngredients.add(key);
    renderChips();
    findMatches();
}

function addCustom() {
    const input = document.getElementById('customIngredient');
    const val = input.value.trim();
    if (val) {
        selectedIngredients.add(val.toLowerCase());
        input.value = '';
        renderChips();
        findMatches();
    }
}

function findMatches() {
    const el = document.getElementById('matchResults');
    if (selectedIngredients.size === 0) {
        el.innerHTML = '';
        return;
    }

    const scored = meals.map(m => {
        let have = [];
        let need = [];

        m.shopping.forEach(item => {
            const itemLower = item.toLowerCase();
            const matched = [...selectedIngredients].some(sel =>
                itemLower.includes(sel) || sel.includes(itemLower.split(' ')[0])
            );
            if (matched) have.push(item);
            else need.push(item);
        });

        return { meal: m, have, need, score: have.length, idx: meals.indexOf(m) };
    });

    const matches = scored.filter(s => s.score > 0).sort((a, b) => b.score - a.score || a.need.length - b.need.length);

    if (matches.length === 0) {
        el.innerHTML = '<div class="no-results">No matching recipes found. Try selecting different ingredients.</div>';
        return;
    }

    el.innerHTML = `<h3>Suggested Meals</h3>` + matches.map((m, i) => {
        const pct = Math.round((m.have.length / m.meal.shopping.length) * 100);
        const barClass = pct === 100 ? 'full' : 'partial';
        const delay = i * 0.08;
        return `
        <div class="match-card" onclick="openModal(${m.idx})" style="animation-delay:${delay}s">
            <h4>${m.meal.emoji} ${m.meal.name}</h4>
            <div class="match-progress">
                <div class="progress-bar">
                    <div class="progress-bar-fill ${barClass}" style="width:${pct}%"></div>
                </div>
                <span class="progress-text">${pct}%</span>
            </div>
            <div class="match-info" style="margin-top:0.3rem">
                <span class="match-have">You have ${m.have.length} of ${m.meal.shopping.length} items</span>
                ${m.need.length > 0 ? `<span class="match-need"> \u2022 Need ${m.need.length} more</span>` : ' \u2022 You have everything!'}
            </div>
            <div class="tag-row">
                ${m.have.map(h => `<span class="tag-have">\u2713 ${h}</span>`).join('')}
                ${m.need.map(n => `<span class="tag-need">+ ${n}</span>`).join('')}
            </div>
        </div>`;
    }).join('');
}

// ============ MODAL CLOSE ANIMATION ============
const styleSheet = document.createElement('style');
styleSheet.textContent = `
    @keyframes modalOut {
        from { opacity: 1; transform: translateY(0) scale(1); }
        to { opacity: 0; transform: translateY(20px) scale(0.95); }
    }
`;
document.head.appendChild(styleSheet);

// ============ INIT ============
renderFilters();
renderMeals();
shufflePlan();
renderChips();
</script>
</body>
</html>
