<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Snake ‚Äî Jimi Hughes</title>
  <meta name="description" content="Classic Snake game ‚Äî eat food, grow longer, avoid the walls. Built by Jimi Hughes.">
  <link rel="icon" type="image/svg+xml" href="../favicon.svg">
  <meta property="og:title" content="Snake ‚Äî Jimi Hughes">
  <meta property="og:description" content="Classic Snake ‚Äî eat food, grow longer, avoid the walls and your own tail.">
  <meta property="og:url" content="https://jimihughes.com/snake/">
  <meta property="og:type" content="website">
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --bg: #0a0a0a;
      --panel: #111;
      --border: #222;
      --text: #fff;
      --text-muted: #666;
      --green: #22c55e;
      --green-dark: #16a34a;
      --red: #ef4444;
    }

    html, body {
      width: 100%; height: 100%;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      overflow: hidden;
    }

    .app {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      gap: 16px;
      padding: 16px;
    }

    /* Header */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      max-width: 440px;
    }

    .back-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      color: var(--text-muted);
      text-decoration: none;
      transition: color 0.2s;
    }
    .back-btn:hover { color: var(--text); }

    .score-area {
      display: flex;
      gap: 24px;
    }

    .score-item {
      text-align: right;
    }

    .score-label {
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: var(--text-muted);
    }

    .score-value {
      font-size: 20px;
      font-weight: 700;
      line-height: 1.2;
    }

    .score-value.green { color: var(--green); }

    /* Canvas wrapper */
    .canvas-wrap {
      position: relative;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid var(--border);
      box-shadow: 0 0 60px rgba(34, 197, 94, 0.08);
    }

    canvas {
      display: block;
    }

    /* Overlay */
    .overlay {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 12px;
      background: rgba(0,0,0,0.85);
      backdrop-filter: blur(6px);
      border-radius: 16px;
    }

    .overlay.hidden { display: none; }

    .overlay-icon {
      font-size: 48px;
      line-height: 1;
    }

    .overlay h2 {
      font-size: 28px;
      font-weight: 800;
      letter-spacing: -0.5px;
    }

    .overlay p {
      font-size: 14px;
      color: var(--text-muted);
    }

    .overlay .final-score {
      font-size: 16px;
      color: var(--text-muted);
    }

    .overlay .final-score span {
      color: var(--green);
      font-weight: 700;
    }

    .play-btn {
      margin-top: 8px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 28px;
      background: var(--green);
      color: #000;
      border: none;
      border-radius: 100px;
      font-size: 14px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.2s;
    }

    .play-btn:hover { background: #4ade80; transform: scale(1.03); }
    .play-btn:active { transform: scale(0.97); }

    /* Controls */
    .controls {
      font-size: 12px;
      color: var(--text-muted);
      text-align: center;
    }

    /* Mobile D-pad */
    .dpad {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }

    .dpad-row {
      display: flex;
      gap: 4px;
    }

    .dpad-btn {
      width: 52px;
      height: 52px;
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      color: var(--text);
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
      transition: background 0.1s;
    }

    .dpad-btn:active { background: #222; }

    @media (max-width: 600px), (pointer: coarse) {
      .dpad { display: flex; }
      .controls { display: none; }
    }

    @media (max-height: 700px) {
      .app { gap: 10px; }
    }
  </style>
</head>
<body>

<div class="app">

  <div class="header">
    <a href="../index.html" class="back-btn">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5"/><path d="M12 19l-7-7 7-7"/></svg>
      Back
    </a>
    <div class="score-area">
      <div class="score-item">
        <div class="score-label">Best</div>
        <div class="score-value" id="bestScore">0</div>
      </div>
      <div class="score-item">
        <div class="score-label">Score</div>
        <div class="score-value green" id="score">0</div>
      </div>
    </div>
  </div>

  <div class="canvas-wrap">
    <canvas id="canvas"></canvas>
    <div class="overlay" id="overlay">
      <div class="overlay-icon">üêç</div>
      <h2>Snake</h2>
      <p>Eat food, don't hit the walls</p>
      <button class="play-btn" id="playBtn">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>
        Play
      </button>
    </div>
  </div>

  <div class="controls">Arrow keys or WASD to move ¬∑ P to pause</div>

  <div class="dpad">
    <div class="dpad-row">
      <div class="dpad-btn" id="up">‚ñ≤</div>
    </div>
    <div class="dpad-row">
      <div class="dpad-btn" id="left">‚óÄ</div>
      <div class="dpad-btn" id="down">‚ñº</div>
      <div class="dpad-btn" id="right">‚ñ∂</div>
    </div>
  </div>

</div>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const overlay = document.getElementById('overlay');
  const playBtn = document.getElementById('playBtn');
  const scoreEl = document.getElementById('score');
  const bestEl = document.getElementById('bestScore');

  const CELL = 20;
  let COLS, ROWS, W, H;

  function resize() {
    const maxW = Math.min(window.innerWidth - 32, 440);
    const maxH = window.innerHeight - 220;
    COLS = Math.floor(Math.min(maxW, maxH) / CELL);
    ROWS = COLS;
    W = COLS * CELL;
    H = ROWS * CELL;
    canvas.width = W;
    canvas.height = H;
    if (state === 'playing') draw();
    else if (state === 'idle' || state === 'dead') drawIdle();
  }

  let snake, dir, nextDir, food, score, best, state, frameId, speed, stepTimer;
  best = parseInt(localStorage.getItem('snake-best') || '0');
  bestEl.textContent = best;
  state = 'idle';

  function init() {
    const mid = Math.floor(COLS / 2);
    snake = [
      { x: mid, y: mid },
      { x: mid - 1, y: mid },
      { x: mid - 2, y: mid },
    ];
    dir = { x: 1, y: 0 };
    nextDir = { x: 1, y: 0 };
    score = 0;
    speed = 120;
    stepTimer = 0;
    scoreEl.textContent = '0';
    spawnFood();
    state = 'playing';
    overlay.classList.add('hidden');
    if (frameId) cancelAnimationFrame(frameId);
    lastTime = null;
    frameId = requestAnimationFrame(loop);
  }

  function spawnFood() {
    let pos;
    do {
      pos = { x: Math.floor(Math.random() * COLS), y: Math.floor(Math.random() * ROWS) };
    } while (snake.some(s => s.x === pos.x && s.y === pos.y));
    food = pos;
  }

  let lastTime = null;

  function loop(ts) {
    if (!lastTime) lastTime = ts;
    const dt = ts - lastTime;
    lastTime = ts;

    if (state !== 'playing') return;

    stepTimer += dt;
    if (stepTimer >= speed) {
      stepTimer -= speed;
      step();
    }

    draw();
    frameId = requestAnimationFrame(loop);
  }

  function step() {
    dir = nextDir;
    const head = { x: snake[0].x + dir.x, y: snake[0].y + dir.y };

    // Wall collision
    if (head.x < 0 || head.x >= COLS || head.y < 0 || head.y >= ROWS) {
      die(); return;
    }
    // Self collision
    if (snake.some(s => s.x === head.x && s.y === head.y)) {
      die(); return;
    }

    snake.unshift(head);

    if (head.x === food.x && head.y === food.y) {
      score++;
      scoreEl.textContent = score;
      if (score > best) {
        best = score;
        bestEl.textContent = best;
        localStorage.setItem('snake-best', best);
      }
      speed = Math.max(60, 120 - score * 3);
      spawnFood();
    } else {
      snake.pop();
    }
  }

  function die() {
    state = 'dead';
    cancelAnimationFrame(frameId);
    showOverlay('dead');
  }

  function draw() {
    // Background
    ctx.fillStyle = '#0a0a0a';
    ctx.fillRect(0, 0, W, H);

    // Grid (subtle)
    ctx.strokeStyle = 'rgba(255,255,255,0.03)';
    ctx.lineWidth = 1;
    for (let x = 0; x <= COLS; x++) {
      ctx.beginPath(); ctx.moveTo(x * CELL, 0); ctx.lineTo(x * CELL, H); ctx.stroke();
    }
    for (let y = 0; y <= ROWS; y++) {
      ctx.beginPath(); ctx.moveTo(0, y * CELL); ctx.lineTo(W, y * CELL); ctx.stroke();
    }

    // Food
    const fx = food.x * CELL + CELL / 2;
    const fy = food.y * CELL + CELL / 2;
    const fr = CELL / 2 - 2;
    const foodGrad = ctx.createRadialGradient(fx - 2, fy - 2, 1, fx, fy, fr);
    foodGrad.addColorStop(0, '#f87171');
    foodGrad.addColorStop(1, '#dc2626');
    ctx.fillStyle = foodGrad;
    ctx.beginPath();
    ctx.arc(fx, fy, fr, 0, Math.PI * 2);
    ctx.fill();

    // Snake
    snake.forEach((seg, i) => {
      const x = seg.x * CELL;
      const y = seg.y * CELL;
      const r = i === 0 ? 6 : 4;
      const t = i / (snake.length - 1 || 1);
      const alpha = 1 - t * 0.4;

      const grad = ctx.createLinearGradient(x, y, x + CELL, y + CELL);
      grad.addColorStop(0, `rgba(34, 197, 94, ${alpha})`);
      grad.addColorStop(1, `rgba(22, 163, 74, ${alpha})`);
      ctx.fillStyle = grad;

      ctx.beginPath();
      ctx.roundRect(x + 2, y + 2, CELL - 4, CELL - 4, r);
      ctx.fill();

      // Eyes on head
      if (i === 0) {
        ctx.fillStyle = '#000';
        const eyeSize = 3;
        let e1, e2;
        if (dir.x === 1)       { e1 = [x+CELL-6, y+5]; e2 = [x+CELL-6, y+CELL-8]; }
        else if (dir.x === -1) { e1 = [x+4, y+5]; e2 = [x+4, y+CELL-8]; }
        else if (dir.y === -1) { e1 = [x+5, y+4]; e2 = [x+CELL-8, y+4]; }
        else                   { e1 = [x+5, y+CELL-6]; e2 = [x+CELL-8, y+CELL-6]; }
        ctx.beginPath(); ctx.arc(e1[0], e1[1], eyeSize, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.arc(e2[0], e2[1], eyeSize, 0, Math.PI*2); ctx.fill();
      }
    });
  }

  function drawIdle() {
    ctx.fillStyle = '#0a0a0a';
    ctx.fillRect(0, 0, W, H);
  }

  function showOverlay(type) {
    overlay.classList.remove('hidden');
    if (type === 'dead') {
      overlay.innerHTML = `
        <div class="overlay-icon">üíÄ</div>
        <h2>Game Over</h2>
        <p class="final-score">Score: <span>${score}</span></p>
        <button class="play-btn" id="playBtn">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg>
          Play Again
        </button>
      `;
    } else {
      overlay.innerHTML = `
        <div class="overlay-icon">‚è∏Ô∏è</div>
        <h2>Paused</h2>
        <button class="play-btn" id="playBtn">Resume</button>
      `;
    }
    document.getElementById('playBtn').addEventListener('click', () => {
      if (type === 'dead') {
        init();
      } else {
        resume();
      }
    });
  }

  function pause() {
    if (state !== 'playing') return;
    state = 'paused';
    cancelAnimationFrame(frameId);
    showOverlay('paused');
  }

  function resume() {
    state = 'playing';
    overlay.classList.add('hidden');
    lastTime = null;
    frameId = requestAnimationFrame(loop);
  }

  // Keyboard
  document.addEventListener('keydown', e => {
    const map = {
      ArrowUp: {x:0,y:-1}, ArrowDown: {x:0,y:1}, ArrowLeft: {x:-1,y:0}, ArrowRight: {x:1,y:0},
      w: {x:0,y:-1}, s: {x:0,y:1}, a: {x:-1,y:0}, d: {x:1,y:0},
      W: {x:0,y:-1}, S: {x:0,y:1}, A: {x:-1,y:0}, D: {x:1,y:0},
    };
    if (map[e.key]) {
      e.preventDefault();
      const nd = map[e.key];
      if (nd.x !== -dir.x || nd.y !== -dir.y) nextDir = nd;
    }
    if (e.key === 'p' || e.key === 'P' || e.key === 'Escape') {
      if (state === 'playing') pause();
      else if (state === 'paused') resume();
    }
    if (e.key === ' ' && state === 'idle') init();
  });

  // D-pad
  function dpad(nx, ny) {
    if (state === 'idle' || state === 'dead') { init(); return; }
    if (state === 'paused') { resume(); return; }
    if (nx !== -dir.x || ny !== -dir.y) nextDir = { x: nx, y: ny };
  }
  document.getElementById('up').addEventListener('click', () => dpad(0, -1));
  document.getElementById('down').addEventListener('click', () => dpad(0, 1));
  document.getElementById('left').addEventListener('click', () => dpad(-1, 0));
  document.getElementById('right').addEventListener('click', () => dpad(1, 0));

  // Touch swipe
  let tx = null, ty = null;
  canvas.addEventListener('touchstart', e => { tx = e.touches[0].clientX; ty = e.touches[0].clientY; }, { passive: true });
  canvas.addEventListener('touchend', e => {
    if (tx === null) return;
    const dx = e.changedTouches[0].clientX - tx;
    const dy = e.changedTouches[0].clientY - ty;
    tx = ty = null;
    if (Math.abs(dx) < 10 && Math.abs(dy) < 10) return;
    if (state === 'idle' || state === 'dead') { init(); return; }
    if (Math.abs(dx) > Math.abs(dy)) {
      dpad(dx > 0 ? 1 : -1, 0);
    } else {
      dpad(0, dy > 0 ? 1 : -1);
    }
  }, { passive: true });

  playBtn.addEventListener('click', init);

  window.addEventListener('resize', resize);
  resize();
  drawIdle();
</script>

</body>
</html>
